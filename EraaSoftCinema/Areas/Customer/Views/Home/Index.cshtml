<!DOCTYPE html>
<html lang="en">
<head>
    @model MoviesVM;
    <meta charset="UTF-8">
    <link rel="stylesheet" href="~/css/site.css">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Cinemas | Interactive Home</title>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/css/site.css">

</head>
<body>
	<section class="header-carousel">

        <div id="header-carousel" class="carousel slide" data-ride="carousel" data-interval="2000" data-pause="hover">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="hero-img" src="img/Movies/Mimgs/Mainimg.jpg" alt="Image" style="object-fit :fill">
                    <div class="carousel-caption  flex-column align-items-center justify-content-center">
                    </div>
                </div>

                @foreach (var item in Model.Movies)
                {
                    <div class="carousel-item">
                        <img class="hero-img" src="img/Movies/Mimgs/@item.MainImgUrl" alt="Image" style="object-fit :fill">
                        <div class="carousel-caption d-flex flex-column align-items-center justify-content-center">
                            <h4 class="text-light text-uppercase font-weight-medium mb-3">@item.genre</h4>
                            <h3 class="display-4 text-white font-weight-semi-bold mb-4">@item.title</h3>
                            <a href="#" class="btn btn-light py-2 px-3">Book Now</a>
                            <div class="p-3" style="max-width: 700px;">
                               
                            </div>
                        </div>
                    </div>
                }

            </div>
            <a class="carousel-control-prev" href="#header-carousel" data-slide="prev">
                <div class="btn btn-dark" style="width: 45px; height: 45px;">
                    <span class="carousel-control-prev-icon mb-n2"></span>
                </div>
            </a>
            <a class="carousel-control-next" href="#header-carousel" data-slide="next">
                <div class="btn btn-dark" style="width: 45px; height: 45px;">
                    <span class="carousel-control-next-icon mb-n2"></span>
                </div>
            </a>
        </div>




    </section>
    <section>

        <div class="col-md-12 p-4" style="padding: 30px;">
                <h3 class="mb-4" >Categories: </h3>

            @if (Model.Categories != null)
            {
                @* Added 'hide-scrollbar' for a cleaner look *@
                <div class="category-carousel-wrapper" style="position: relative; overflow: hidden;">


                    <div class="slider-container" id="categorySlider" style="display:flex; overflow-x: auto; scroll-behavior: smooth;">
                        <button class="nav-btn left" onclick="scrollSlider(-1)">&#10094;</button>

                        @foreach (var cate in Model.Categories)
                        {
                            <div class="actor-card text-center" style="flex: 1 0 auto; min-width: 120px; max-width: 200px; margin:0 5px;">
                                <div class="img-container mb-2">
                                    <img src="~/img/Category/@cate.imgUrl"
                                         class="actor-img rounded-circle border shadow-sm"
                                         alt="@cate.name"
                                         style="width: 100px; height: 100px; object-fit: cover;">
                                </div>
                                <h6 class="mt-2 mb-1 text-truncate" title="@cate.name">@cate.name</h6>
                            </div>
                        }
                        <button class="nav-btn right" onclick="scrollSlider(1)">&#10095;</button>

                    </div>

                </div>

            }
            else
            {
                <div class="alert alert-info">
                    No Category found
                </div>
            }
        </div>

    </section>


  <section class="movie-category-header">
        <div class="category-tabs">
            <button class="tab-btn active">Now Showing</button>
            <button class="tab-btn">Coming Soon</button>
        </div>
        <form method="get" asp-action="Index">
            <div class="filter-group d-flex align-items-center gap-3">
                <span class="filter-label">Categories:</span>

                <select class="cinema-dropdown"
                        asp-for="SelectedCategoryId"
                        asp-items="@(new SelectList(Model.Categories, "id", "name"))"
                        onchange="this.form.submit()">
                    <option value="">All Genres</option>
                </select>

                @if (Model.SelectedCategoryId != null)
                {
                    <a asp-controller="Home"
                       asp-action="Index"
                      
                       asp-route-SelectedCategoryId=""
                       class="btn btn-outline-secondary btn-sm">
                        Clear Filter
                    </a>
                }
            </div>
        </form>
    </section>

	<section class="movie-grid-section">
    <div class="movie-grid" id="movieList" >
        @foreach (var movie in Model.Movies)
        {
            <div class="poster-wrapper">
                <a asp-controller="Home" asp-action="MovieInfo" asp-route-id="@movie.id" >
                    <div class="rating-badge">R15</div>
                    <img src="~/img/Movies/Mimgs/@movie.MainImgUrl" alt="@movie.title">
                    <div class="movie-title">

                        <h2 class="movie-lang">@movie.Language?.name</h2>
                        <h2 class="movie-genre">@movie.genre</h2>
                        <h2>@movie.title</h2>

                        @* The button becomes a visual cue now *@
                        <span class="btn btn-primary"></span>
                    </div>
                  
                </a>
                <div class="movie-title">


                </div>
            </div>
          
        }
    </div>
    </section>

    <div class="d-flex align-items-center justify-content-center">
      
        <!-- Pagination -->
        <nav>
            <ul class="pagination justify-content-end" >
                <li class="page-item @(Model.CurrentPage == 0 ? "disable" : "")">

                    @if (Model.CurrentPage > 1)
                    {
                        <a class="page-link"
                           href="@(Model.CurrentPage == 1 ? "#" : $"?page={Model.CurrentPage - 1}")">
                            Previous
                        </a>
                    }

                </li>

                <!-- Page Numbers -->
                @for (int i = 1; i <= Model.TotalPages; i++)
                {
                    <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                        <a class="page-link" href="?page=@i">@i</a>
                    </li>
                }

                <!-- Next -->
                @if (Model.TotalPages > 1)
                {

                    <li class="page-item @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")">
                        <a class="page-link"
                           href="@(Model.CurrentPage == Model.TotalPages ? "#" : $"?page={Model.CurrentPage + 1}")">
                            Next
                        </a>
                    </li>

                }




            </ul>
        </nav>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function scrollSlider(direction) {
            const slider = document.getElementById('categorySlider');
            const scrollAmount = 200; // pixels per click

            // scroll left or right
            slider.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }
    </script>


</body>
</html>